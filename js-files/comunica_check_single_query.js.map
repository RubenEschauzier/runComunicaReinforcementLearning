{"version":3,"file":"comunica_check_single_query.js","sourceRoot":"","sources":["../comunica_check_single_query.ts"],"names":[],"mappings":";;AAEA,MAAM,cAAc;IAGhB;QACI,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC,6BAA6B,CAAC,CAAC,kBAAkB,CAAC;IACxF,CAAC;IAEM,KAAK,CAAC,YAAY;QACrB,iIAAiI;QACjI,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,IAAI,CAAC,kBAAkB,EAAE,CAAC,MAAM,EAAE,CAAC;IAE/D,CAAC;IAEM,KAAK,CAAC,aAAa,CAAC,aAA6B,EAAE,SAAiB;QACvE,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,MAAM,aAAa,GAAa,EAAE,CAAC;QACnC,MAAM,eAAe,GAAqB,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACtE,aAAa,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,GAAQ,EAAE,EAAE;gBAClC,UAAU,IAAI,CAAC,CAAC;gBAChB,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,GAAG,SAAS,CAAC,CAAA;YAC3D,CAAC,CAAC,CAAC;YACH,aAAa,CAAC,EAAE,CAAC,KAAK,EAAE,GAAG,EAAE;gBACzB,MAAM,OAAO,GAAG,MAAM,CAAC,cAAc,EAAE,GAAG,SAAS,CAAC;gBACpD,OAAO,CAAC,GAAG,CAAC,yBAAyB,OAAO,EAAE,CAAC,CAAC;gBAChD,OAAO,CAAC,GAAG,CAAC,sBAAsB,UAAU,EAAE,CAAC,CAAC;gBAChD,OAAO,CAAC,GAAG,CAAC,gCAAgC,aAAa,EAAE,CAAC,CAAC;gBAC7D,OAAO,CAAC,IAAI,CAAC,CAAA;YACjB,CAAC,CAAC,CAAC;YACH,aAAa,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE;gBAC3B,MAAM,CAAC,IAAI,CAAC,CAAA;YAChB,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;QAEH,OAAO,eAAe,CAAA;IAC1B,CAAC;IAEM,cAAc;QACjB,MAAM,MAAM,GAAa,OAAO,CAAC,MAAM,EAAE,CAAC;QAC1C,MAAM,IAAI,GAAW,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;QACxD,OAAO,IAAI,CAAA;IACf,CAAC;CAEJ;AAED,MAAM,YAAY,GAAG;;;;;;;;;EASnB,CAAA;AAEF,MAAM,KAAK,GAAG;;;;;EAKZ,CAAA;AAEF,MAAM,OAAO,GAAG,EAAE,CAAC;AACnB,MAAM,MAAM,GAAG,IAAI,cAAc,EAAE,CAAC;AACpC,MAAM,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE;IAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAC,OAAO,EAAE,CAAC,EAAE,EAAC;QAC3B,MAAM,SAAS,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;QAC1C,MAAM,YAAY,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,EAAC,OAAO,EAAE,CAAC,iBAAiB,CAAC,EAAE,aAAa,EAAE,IAAI,EAAC,CAAC,CAAC;QACnH,MAAM,MAAM,CAAC,aAAa,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QAC7E,sBAAsB;QACtB,sCAAsC;QACtC,0CAA0C;QAC1C,+BAA+B;QAC/B,uBAAuB;QACvB,8DAA8D;QAC9D,MAAM;QACN,gCAAgC;QAChC,2DAA2D;QAC3D,uDAAuD;QACvD,uDAAuD;QACvD,oEAAoE;QACpE,UAAU;KACb;IAAA,CAAC;AACN,CAAC,CAAC,CAAC","sourcesContent":["import {BindingsStream} from \"@comunica/types\";\n\nclass runExperiments{\n    public engine: any;\n    public queryEngineFactory: any;\n    public constructor(){\n        this.queryEngineFactory = require(\"@comunica/query-sparql-file\").QueryEngineFactory;\n    }\n\n    public async createEngine(){\n        // this.engine = await new this.queryEngineFactory().create({configPath: \"configFiles/config-default-variable-priorities.json\"});\n        this.engine = await new this.queryEngineFactory().create();\n\n    }\n\n    public async consumeStream(bindingStream: BindingsStream, startTime: number){\n        let numResults = 0;\n        const timingResults: number[] = [];\n        const finishedReading: Promise<boolean> = new Promise((resolve, reject) => {\n            bindingStream.on('data', (res: any) => {\n                numResults += 1;\n                timingResults.push(runner.getTimeSeconds() - startTime)\n            });\n            bindingStream.on('end', () =>{\n                const elapsed = runner.getTimeSeconds() - startTime;\n                console.log(`Total execution time: ${elapsed}`);\n                console.log(`Number of results: ${numResults}`);\n                console.log(`Result arrival distribution: ${timingResults}`);\n                resolve(true)\n            });\n            bindingStream.on('error', () =>{\n                reject(true)\n            });\n        });\n\n        return finishedReading\n    }\n\n    public getTimeSeconds(){\n        const hrTime: number[] = process.hrtime();\n        const time: number = hrTime[0] + hrTime[1] / 1000000000;\n        return time\n    }\n\n}\n\nconst queryComplex = `SELECT ?v0 ?v4 ?v6 ?v7 WHERE {\n\t?v0 <http://schema.org/caption> ?v1 .\n\t?v0 <http://schema.org/text> ?v2 .\n\t?v0 <http://schema.org/contentRating> ?v3 .\n\t?v0 <http://purl.org/stuff/rev#hasReview> ?v4 .\n\t?v4 <http://purl.org/stuff/rev#title> ?v5 .\n\t?v4 <http://purl.org/stuff/rev#reviewer> ?v6 .\n\t?v7 <http://schema.org/actor> ?v6 .\n\t?v7 <http://schema.org/language> ?v8 .\n}`\n\nconst query = `SELECT ?v0 ?v1 ?v3 WHERE {\n\t?v0 <http://purl.org/dc/terms/Location> ?v1 .\n\t?v0 <http://schema.org/nationality> <http://db.uwaterloo.ca/~galuc/wsdbm/Country24> .\n\t?v0 <http://db.uwaterloo.ca/~galuc/wsdbm/gender> ?v3 .\n\t?v0 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://db.uwaterloo.ca/~galuc/wsdbm/Role2> .\n}`\n\nconst numRuns = 20;\nconst runner = new runExperiments();\nrunner.createEngine().then(async () => {\n    for (let i = 0; i<numRuns; i++){\n        const startTime = runner.getTimeSeconds();\n        const outputStream = await runner.engine.queryBindings(query, {sources: [\"/tmp/dataset.nt\"], trainEndPoint: true});\n        await runner.consumeStream(outputStream, startTime).catch(err => alert(err));\n        // let numResults = 0;\n        // const timingResults: number[] = [];\n        // outputStream.on('data', (res: any) => {\n        //     console.log(res.entries)\n        //     numResults += 1;\n        //     timingResults.push(runner.getTimeSeconds() - startTime)\n        // });\n        // outputStream.on('end', () =>{\n        //     const elapsed = runner.getTimeSeconds() - startTime;\n        //     console.log(`Total execution time: ${elapsed}`);\n        //     console.log(`Number of results: ${numResults}`);\n        //     console.log(`Result arrival distribution: ${timingResults}`);\n        // });    \n    };\n});\n\n"]}